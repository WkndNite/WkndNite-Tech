---
title: 操作系统的结构
description: 操作系统的结构
sidebar:
    order: 1
---

> _我感觉自己现在就像是一个操作系统：所有的请求都被系统调用处理。每天的参数都从寄存器传过来，有时堆栈溢出，有时内存泄漏，但我依然运行在这个用户层，咬牙坚持。_

## 操作系统的服务

---

![操作系统的服务](@src/assets/os/structure-service.excalidraw.png)

操作系统以不同形式向程序和用户提供服务，这些服务包括：用户界面、程序执行、I/O 操作、文件系统操作、通信、错误检测等**基本服务**和资源分配、统计、保护和安全等**扩展服务**。

## 操纵系统的用户界面

---

操作系统的用户界面可以分为 **CLI** 和 **GUI** 两种。

## 系统调用

---

是操作系统服务的编程接口，通常用高级语言编写，程序通过 API 访问，而不是直接使用系统调用。

每个系统调用都有一个**固有番号**，操作系统通过一张系统调用番号表来管理系统调用接口。因此，系统调用接口是操作系统内核与用户程序之间的桥梁。而一般情况下系统调用被运行库管理，运行库提供 API 供用户程序调用。

> Q : 系统调用如何传递参数？

> A : 向系统调用函数传递参数的方式有三种：**寄存器**、**堆栈**、**内存块**。

系统调用大致可以分为以下几个类别：

-   进程控制
-   文件操作
-   通信管理
-   信息维护
-   设备管理
-   权限保护

## 系统程序

---

系统程序的存在为用户提供了一个**友好的接口**，使得用户可以方便地使用计算机资源。

:::note
系统程序不属于内核，但属于操作系统的一部分。
:::

> Q : 应用程序和系统程序之间有什么区别？

> A : 应用程序是用户编写的程序，系统程序是操作系统的一部分，用于提供操作系统服务。此外，应用程序是用户直接使用的，而系统程序是操作系统内部使用的。

## 操作系统的设计和实现

---

OS 的设计和实现没有完整的解决方案，不同类型的操作系统内部结构不同，因此，OS 的设计和实现需要根据具体的需求和目标进行定制。

1. 设计目标包括用户目标和开发目标，用户目标包括提供用户友好、高效、可靠、安全的操作系统，开发目标包括提高系统的可移植性、可扩展性、可维护性等。

2. 操作系统的设计需要考虑到策略与机制的分离，策略是指操作系统如何实现某种功能，机制是指操作系统如何实现策略。简单来说，策略决定做什么，机制决定怎么做。

3. 操作系统的实现会借助的开发语言，如 C、C++、Java 等。在早期，OS 的实现主要使用汇编语言，随着计算机硬件的发展，C 语言逐渐成为 OS 的主要开发语言。而实际开发过程中，经常会混合多种语言进行开发，如底层用汇编，上层用 C。

## 操作系统的结构

---

操作系统的结构可以划分为简单结构、层次结构、微内核结构、模块化结构、混合结构等。

早期操纵系统规模小、简单、功能有限，因此，早期操作系统采用**简单结构**，如单用户单任务操作系统、批处理操作系统等。

随着计算机规模的扩大，操纵系统被划分为若干层次，在较低的层次上构建高层。底层为硬件，最高层为用户层。每一层只能使用较低层次的功能和服务。**层次结构**的存在简化了系统的设计和实现，便于调试和升级维护，但是由于其定义形式，效率相对较差。

**微内核结构**是一种新型的操作系统结构，它将操作系统划分为内核和微内核两部分。微内核只提供最基本的操作系统服务，如进程管理、内存管理、中断处理等。而其他的服务则由用户态的进程来实现。微内核结构具有较好的可扩展性和可移植性，但是其实现较为复杂，效率相对较低。

**模块化结构**是一种将操作系统划分为若干模块的结构，每个模块负责实现一种功能。模块化结构具有较好的可扩展性和可维护性，但是其实现较为复杂，效率相对较低。

**混合结构**是一种将上述几种结构混合使用的一种结构，如将微内核结构和模块化结构混合使用，以实现更好的可扩展性和可维护性。

## 虚拟机

---

**虚拟机**是通过软件模拟的具有完整硬件系统功能的、运行在一个完全隔离环境中的完整计算机系统。

虚拟机技术可以实现在一台物理机上运行多个操作系统，每个操作系统都运行在一个独立的虚拟机中，彼此之间互不影响。虚拟机技术可以用于测试、开发和部署应用程序，也可以用于提高计算机资源的利用率。
